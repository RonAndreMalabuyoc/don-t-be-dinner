[gd_scene load_steps=47 format=3 uid="uid://dl6d3lwiivjxg"]

[ext_resource type="Texture2D" uid="uid://bm5w7ih0ujtsx" path="res://assets/winning_dance-Sheet.png" id="1_2q423"]
[ext_resource type="Texture2D" uid="uid://b24tj1r88ew7v" path="res://assets/idle_right-Sheet.png" id="1_48ufq"]
[ext_resource type="PackedScene" uid="uid://0c7kqgockbqo" path="res://scenes/Bullets/BreadBullet_Throw.tscn" id="1_ogw1n"]
[ext_resource type="Texture2D" uid="uid://drv57nqyv7011" path="res://assets/jump_right-Sheet.png" id="2_uvl38"]
[ext_resource type="Texture2D" uid="uid://dio8s4h1seupc" path="res://assets/walk_right-Sheet.png" id="2_wmkwl"]
[ext_resource type="Texture2D" uid="uid://dcku5knbb872k" path="res://assets/Duck/24_hurtduck_left-Sheet.png" id="4_0d0nc"]
[ext_resource type="Texture2D" uid="uid://xfs8i5sosg3v" path="res://assets/shoot_right_duck-Sheet.png" id="6_2v62t"]

[sub_resource type="GDScript" id="GDScript_48ufq"]
resource_name = "Movement"
script/source = "extends CharacterBody2D

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ MOVEMENT â”€â”€â”€â”€â”€â”€â”€â”€â”€
@export var speed := 400
@export var jump_force := -600
@export var gravity := 1200
@export var hurt_knockback_damp := 1800.0

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ DASH â”€â”€â”€â”€â”€â”€â”€â”€â”€
@export var dash_speed := 900.0
@export var dash_duration := 0.12
@export var dash_cooldown := 1.5

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ SHOOTING â”€â”€â”€â”€â”€â”€â”€â”€â”€
@export var shoot_cooldown := 0.3
@export var bullet_scene: PackedScene
const SHOOT_FRAME := 3
var shoot_direction: Vector2 = Vector2.RIGHT

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ FRUIT SHOOTING â”€â”€â”€â”€â”€â”€â”€â”€â”€
@export var fruit_shoot_cooldown := 0.3
@export var fruit_projectiles := {
	\"Pomegranate\": preload(\"res://scenes/Bullets/PomegranateBullet_Throw.tscn\"),
	\"Orange\": preload(\"res://scenes/Bullets/OrangeBullet_Throw.tscn\"),
	\"Banana\": preload(\"res://scenes/Bullets/BananaBullet_Throw.tscn\"),
	\"Coconut\": preload(\"res://scenes/Bullets/CoconutBullet_Throw.tscn\"),
}

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ HEALTH â”€â”€â”€â”€â”€â”€â”€â”€â”€
@export var max_health := 30
@export var hurt_lock_time := 0.25
@export var invulnerability_time := 1.3
@export var blink_interval := 0.1
var is_invulnerable := false
var current_health := 100
var is_dead := false
var can_take_damage := true
const INVINCIBILITY_TIME := 1.3

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ NODES â”€â”€â”€â”€â”€â”€â”€â”€â”€
@onready var sprite: AnimatedSprite2D = $AnimatedSprite2D
@onready var shoot_point: Node2D = $ShootPoint
@onready var hitbox: Area2D = $Hitbox
@onready var camera: Camera2D = $Camera2D
@onready var fruit_ui_current: Label = get_tree().current_scene.get_node(\"HUD/FruitUI/Current_fruit\")
@onready var fruit_ui_reserve: Label = get_tree().current_scene.get_node_or_null(\"HUD/FruitUI/Reserve_fruit\")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€
var facing_right := true
var is_dashing := false
var can_dash := true
var dash_time_left := 0.0
var dash_dir := 0.0
var is_hurt := false
const HURT_ANIM_TIME := 1.0
var hurt_dir := 0

var can_shoot := true
var is_emoting := false
var shot_fired_this_anim := false

var can_shoot_fruit := true

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ READY â”€â”€â”€â”€â”€â”€â”€â”€â”€
func _ready():
	Global.playerbody = self
	Global.player_alive = true
	current_health = max_health

	hitbox.body_entered.connect(_on_hitbox_body_entered)
	hitbox.area_entered.connect(_on_hitbox_area_entered)
	sprite.frame_changed.connect(_on_sprite_frame_changed)

	print(\"PLAYER READY:\", get_path())
	_debug_slots(\"Ready\")
	
	_update_fruit_ui()
	print(\"UI current path:\", fruit_ui_current.get_path() if is_instance_valid(fruit_ui_current) else \"MISSING\")
	print(\"UI reserve path:\", fruit_ui_reserve.get_path() if is_instance_valid(fruit_ui_reserve) else \"MISSING\")


# â”€â”€â”€â”€â”€â”€â”€â”€â”€ PHYSICS â”€â”€â”€â”€â”€â”€â”€â”€â”€
func _physics_process(delta):
	# HURT LOCK
	if is_hurt:
		velocity.y += gravity * delta

		# Horizontal knockback damping
		velocity.x = move_toward(velocity.x, 0, hurt_knockback_damp * delta)

		# Extra damping once grounded
		if is_on_floor():
			velocity.x = move_toward(velocity.x, 0, hurt_knockback_damp * 2 * delta)

		move_and_slide()
		return

	if Input.is_action_just_pressed(\"dance\"):
		is_emoting = !is_emoting

	# â”€â”€â”€â”€â”€â”€â”€â”€â”€ FRUIT INPUT â”€â”€â”€â”€â”€â”€â”€â”€â”€
	if Input.is_action_just_pressed(\"fruit_shoot\"):
		print(\"INPUT: fruit_shoot pressed\")
		shoot_fruit()

	if Input.is_action_just_pressed(\"swap_fruit\"):
		print(\"INPUT: swap_fruit pressed\")
		swap_fruit_slots()
	# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

	if is_dead:
		return

	# Dance lock
	if is_emoting:
		velocity.x = 0
		handle_animations()
		move_and_slide()
		return

	# Gravity
	if not is_on_floor() and not is_dashing:
		velocity.y += gravity * delta

	# Dash
	if Input.is_action_just_pressed(\"dash\") and can_dash and not is_emoting and not is_dashing:
		start_dash()

	if is_dashing:
		dash_time_left -= delta
		velocity.x = dash_dir * dash_speed
		velocity.y = 0
		if dash_time_left <= 0:
			stop_dash()
	else:
		var direction := Input.get_axis(\"Left\", \"Right\")
		if direction != 0 and not is_emoting:
			velocity.x = direction * speed
			facing_right = direction > 0
		else:
			velocity.x = move_toward(velocity.x, 0, 40)

		if Input.is_action_just_pressed(\"jump\") and is_on_floor() and not is_emoting:
			velocity.y = jump_force

	handle_animations()
	sprite.flip_h = not facing_right
	move_and_slide()

func get_shoot_direction() -> Vector2:
	var mouse_pos = get_global_mouse_position()
	var dir = (mouse_pos - shoot_point.global_position).normalized()
	return dir

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ DASH â”€â”€â”€â”€â”€â”€â”€â”€â”€
func start_dash():
	can_dash = false
	is_dashing = true
	dash_time_left = dash_duration

	var input_dir := Input.get_axis(\"Left\", \"Right\")
	if input_dir != 0:
		dash_dir = sign(input_dir)
	else:
		dash_dir = 1 if facing_right else -1

	facing_right = dash_dir > 0

	await get_tree().create_timer(dash_cooldown).timeout
	can_dash = true

func stop_dash():
	is_dashing = false
	velocity.x = move_toward(velocity.x, 0, 200)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ SHOOTING â”€â”€â”€â”€â”€â”€â”€â”€â”€
func shoot():
	var bullet := Global.instance_node(
		bullet_scene,
		shoot_point.global_position,
		Global.node_creation_parent
	) as Bullet

	# Direction from shoot point to mouse
	var mouse_pos = get_global_mouse_position()
	bullet.direction = (mouse_pos - shoot_point.global_position).normalized()

func _on_sprite_frame_changed():
	if sprite.animation != \"shoot\":
		return

	if sprite.frame == SHOOT_FRAME and not shot_fired_this_anim:
		shot_fired_this_anim = true
		if bullet_scene and Global.node_creation_parent:
			var bullet = Global.instance_node(
				bullet_scene,
				shoot_point.global_position,
				Global.node_creation_parent
			) as Bullet
			bullet.direction = get_shoot_direction()
	if sprite.frame == sprite.sprite_frames.get_frame_count(\"shoot\") - 1:
		shot_fired_this_anim = false

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ FRUIT SHOOTING â”€â”€â”€â”€â”€â”€â”€â”€â”€
func shoot_fruit() -> void:
	print(\"shoot_fruit() called\")

	if not can_shoot_fruit:
		print(\"Fruit shoot blocked by cooldown\")
		return

	if current_fruit == \"\":
		print(\"No current fruit to shoot.\")
		return

	var fruit_id := current_fruit
	print(\"Shooting fruit:\", fruit_id)

	if not fruit_projectiles.has(fruit_id) or fruit_projectiles[fruit_id] == null:
		print(\"No projectile scene set for fruit:\", fruit_id)
		return

	can_shoot_fruit = false

	# Spawn fruit projectile like normal bullets
	var proj_scene: PackedScene = fruit_projectiles[fruit_id]
	var proj := Global.instance_node(
		proj_scene,
		shoot_point.global_position,
		Global.node_creation_parent
	)

	# Set direction for common bullet scripts
	var dir := get_shoot_direction()
	if proj != null:
		if \"direction\" in proj:
			proj.direction = dir
		elif proj.has_method(\"setup\"):
			proj.call(\"setup\", dir)

	# Consume current fruit
	current_fruit = \"\"
	print(\"Consumed fruit:\", fruit_id)

	# Auto-load reserve into current
	if reserve_fruit != \"\":
		current_fruit = reserve_fruit
		reserve_fruit = \"\"
		print(\"Auto-loaded reserve into current:\", current_fruit)

	_debug_slots(\"After Fruit Shoot\")

	_update_fruit_ui()

	await get_tree().create_timer(fruit_shoot_cooldown).timeout
	can_shoot_fruit = true
	print(\"Fruit shoot cooldown finished\")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ ANIMATIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€
func handle_animations():
	if is_hurt:
		return

	if Input.is_action_pressed(\"shoot\"):
		var mouse_x := get_global_mouse_position().x
		facing_right = mouse_x > global_position.x

	if is_dead:
		return

	# Dance overrides everything
	if is_emoting:
		if sprite.animation != \"dance\":
			sprite.play(\"dance\")
		return

	# Dash
	if is_dashing:
		sprite.play(\"dash\" if sprite.sprite_frames.has_animation(\"dash\") else \"walk\")
		return

	# ðŸ”¥ JUMP / FALL (MOST IMPORTANT FIX)
	if not is_on_floor():
		if velocity.y < 0:
			if sprite.animation != \"jump\":
				sprite.play(\"jump\")
		else:
			if sprite.animation != \"fall\" and sprite.sprite_frames.has_animation(\"fall\"):
				sprite.play(\"fall\")
		return

	# Shoot
	if Input.is_action_pressed(\"shoot\"):
		sprite.play(\"shoot\")
		return

	# Walk / Idle
	if abs(velocity.x) > 10:
		sprite.play(\"walk\")
	else:
		sprite.play(\"idle\")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ DAMAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€
func _on_hitbox_body_entered(body):
	if is_dead or not can_take_damage:
		return

	if body.is_in_group(\"Enemy\") and \"damage_amount\" in body:
		hurt_dir = sign(global_position.x - body.global_position.x)
		take_damage(body.damage_amount)

func _on_hitbox_area_entered(area):
	if is_dead or not can_take_damage:
		return

	if area.is_in_group(\"EnemyDamage\"):
		hurt_dir = sign(global_position.x - area.global_position.x)
		take_damage(10)

func take_damage(amount: int):
	if is_dead or is_hurt or is_invulnerable:
		return

	current_health -= amount

	if current_health <= 0:
		die()
		return

	start_hurt_and_invincibility()

func start_hurt_and_invincibility():
	is_hurt = true
	is_invulnerable = true
	can_take_damage = false
	hitbox.monitoring = false

	# Face attacker
	facing_right = hurt_dir < 0
	sprite.flip_h = not facing_right

	# Apply knockback immediately
	velocity.x = hurt_dir * 320
	velocity.y = -220

	# FORCE hurt animation
	sprite.stop()
	sprite.play(\"hurt\")

	# Wait for animation to finish (THIS IS THE KEY)
	await sprite.animation_finished

	# End hurt lock, allow movement
	is_hurt = false

	# Start invulnerability blinking
	start_blinking()

func start_blinking():
	var elapsed := 0.0

	while elapsed < invulnerability_time:
		sprite.visible = false
		await get_tree().create_timer(blink_interval).timeout
		sprite.visible = true
		await get_tree().create_timer(blink_interval).timeout
		elapsed += blink_interval * 2

	end_invulnerability()

func end_invulnerability():
	is_invulnerable = false
	can_take_damage = true
	hitbox.monitoring = true
	sprite.visible = true

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ DEATH â”€â”€â”€â”€â”€â”€â”€â”€â”€
func die():
	is_dead = true
	Global.player_alive = false
	sprite.play(\"death\")
	sprite.modulate = Color.WHITE

	if camera:
		create_tween().tween_property(camera, \"zoom\", Vector2(3, 3), 0.5)

	await get_tree().create_timer(3.0).timeout
	queue_free()

# â”€â”€â”€â”€â”€â”€â”€â”€â”€ FRUIT SLOTS â”€â”€â”€â”€â”€â”€â”€â”€â”€
var current_fruit: String = \"\"
var reserve_fruit: String = \"\"

func _debug_slots(context: String) -> void:
	print(\"[\" + context + \"] Current:\", current_fruit, \" | Reserve:\", reserve_fruit)

func push_powerup(item_id: String, duration: float = -1.0, auto_fire: bool = false) -> void:
	print(\"push_powerup called with:\", item_id, \" auto_fire:\", auto_fire)

	if current_fruit == \"\":
		current_fruit = item_id
		_debug_slots(\"Pickup -> Filled Current\")
	elif reserve_fruit == \"\":
		reserve_fruit = item_id
		_debug_slots(\"Pickup -> Filled Reserve\")
	else:
		reserve_fruit = item_id
		_debug_slots(\"Pickup -> Replaced Reserve\")

	_update_fruit_ui()

func swap_fruit_slots() -> void:
	print(\"Swap key pressed\")

	if current_fruit == \"\" and reserve_fruit == \"\":
		print(\"Nothing to swap (both empty)\")
		return

	var tmp := current_fruit
	current_fruit = reserve_fruit
	reserve_fruit = tmp
	_debug_slots(\"After Swap\")
	
	_update_fruit_ui()

func _fruit_name_or_empty(v: String) -> String:
	return v if v != \"\" else \"(empty)\"


func _update_fruit_ui() -> void:
	if is_instance_valid(fruit_ui_current):
		fruit_ui_current.text = \"Current: \" + _fruit_name_or_empty(current_fruit)

	if is_instance_valid(fruit_ui_reserve):
		fruit_ui_reserve.text = \"Reserve: \" + _fruit_name_or_empty(reserve_fruit)
"

[sub_resource type="AtlasTexture" id="AtlasTexture_qthh5"]
atlas = ExtResource("1_2q423")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_1vudk"]
atlas = ExtResource("1_2q423")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_k7f46"]
atlas = ExtResource("1_2q423")
region = Rect2(64, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_wtyc1"]
atlas = ExtResource("1_2q423")
region = Rect2(96, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_wevls"]
atlas = ExtResource("1_2q423")
region = Rect2(128, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_8013f"]
atlas = ExtResource("1_2q423")
region = Rect2(160, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_ogw1n"]
atlas = ExtResource("6_2v62t")
region = Rect2(96, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_0d0nc"]
atlas = ExtResource("6_2v62t")
region = Rect2(128, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_d3a2h"]
atlas = ExtResource("6_2v62t")
region = Rect2(160, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_0ltrl"]
atlas = ExtResource("4_0d0nc")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_kvjf6"]
atlas = ExtResource("4_0d0nc")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_hj3w6"]
atlas = ExtResource("4_0d0nc")
region = Rect2(64, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_hodpe"]
atlas = ExtResource("4_0d0nc")
region = Rect2(96, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_wmkwl"]
atlas = ExtResource("1_48ufq")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_uvl38"]
atlas = ExtResource("1_48ufq")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_2q423"]
atlas = ExtResource("1_48ufq")
region = Rect2(64, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_8yqgs"]
atlas = ExtResource("1_48ufq")
region = Rect2(96, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_jw0ju"]
atlas = ExtResource("1_48ufq")
region = Rect2(128, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_2v62t"]
atlas = ExtResource("1_48ufq")
region = Rect2(160, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_47qjj"]
atlas = ExtResource("2_uvl38")
region = Rect2(96, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_dypn8"]
atlas = ExtResource("2_uvl38")
region = Rect2(128, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_07ek2"]
atlas = ExtResource("2_uvl38")
region = Rect2(160, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_kg3iu"]
atlas = ExtResource("2_uvl38")
region = Rect2(192, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_mjyag"]
atlas = ExtResource("2_uvl38")
region = Rect2(224, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_tiulj"]
atlas = ExtResource("6_2v62t")
region = Rect2(224, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_bdwkj"]
atlas = ExtResource("6_2v62t")
region = Rect2(192, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_pmoru"]
atlas = ExtResource("6_2v62t")
region = Rect2(160, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_2g5xf"]
atlas = ExtResource("6_2v62t")
region = Rect2(128, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_0yo88"]
atlas = ExtResource("6_2v62t")
region = Rect2(96, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_dbwko"]
atlas = ExtResource("6_2v62t")
region = Rect2(64, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_ei42f"]
atlas = ExtResource("6_2v62t")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_auo7h"]
atlas = ExtResource("6_2v62t")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_wcpx6"]
atlas = ExtResource("2_wmkwl")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_u3evn"]
atlas = ExtResource("2_wmkwl")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_5q0wt"]
atlas = ExtResource("2_wmkwl")
region = Rect2(64, 0, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_wcpx6"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_qthh5")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_1vudk")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_k7f46")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_wtyc1")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_wevls")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_8013f")
}],
"loop": true,
"name": &"dance",
"speed": 8.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_ogw1n")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_0d0nc")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_d3a2h")
}],
"loop": true,
"name": &"dash",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_0ltrl")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_kvjf6")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_hj3w6")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_hodpe")
}],
"loop": false,
"name": &"hurt",
"speed": 4.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_wmkwl")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_uvl38")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_2q423")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_8yqgs")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_jw0ju")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_2v62t")
}],
"loop": true,
"name": &"idle",
"speed": 8.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_47qjj")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_dypn8")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_07ek2")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_kg3iu")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_mjyag")
}],
"loop": false,
"name": &"jump",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_tiulj")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_bdwkj")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_pmoru")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_2g5xf")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_0yo88")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_dbwko")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ei42f")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_auo7h")
}],
"loop": false,
"name": &"shoot",
"speed": 12.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_wcpx6")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_u3evn")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_5q0wt")
}],
"loop": true,
"name": &"walk",
"speed": 6.0
}]

[sub_resource type="CircleShape2D" id="CircleShape2D_ogw1n"]
radius = 36.124783

[sub_resource type="CircleShape2D" id="CircleShape2D_0d0nc"]
radius = 37.0

[node name="Player" type="CharacterBody2D"]
z_index = 5
script = SubResource("GDScript_48ufq")
bullet_scene = ExtResource("1_ogw1n")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
position = Vector2(0.5, -9.5)
scale = Vector2(3.15625, 3.21875)
sprite_frames = SubResource("SpriteFrames_wcpx6")
animation = &"hurt"
frame = 2
frame_progress = 1.0

[node name="Hitbox" type="Area2D" parent="."]
collision_layer = 0
collision_mask = 4

[node name="CollisionShape2D" type="CollisionShape2D" parent="Hitbox"]
position = Vector2(1, 5)
shape = SubResource("CircleShape2D_ogw1n")

[node name="ShootPoint" type="Marker2D" parent="."]
position = Vector2(-31, -29)

[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2(0, -141)

[node name="Reload_speed" type="Timer" parent="."]
wait_time = 0.75
autostart = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(1, 5)
shape = SubResource("CircleShape2D_0d0nc")

[connection signal="timeout" from="Reload_speed" to="." method="_on_timer_timeout"]
